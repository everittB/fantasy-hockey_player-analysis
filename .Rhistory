player <- read_delim("data/players.txt", delim = ",")
# Load data
player <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
# Load data
player <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
# Get player list
forwards_list <-  player %>%
filter(posType == "Forward" ) %>%
pull(fullName) %>%
as.list()
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
# Get player list
forwards_list <-  player %>%
filter(posType == "Forward" ) %>%
pull(fullName) %>%
as.list()
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
# Get defences players list
forwards_list <-  player %>%
filter(posType == "Defenseman" ) %>%
pull(fullName) %>%
as.list()
# Get forwards player list
forwards_list <-  player %>%
filter(posType == "Forward" ) %>%
pull(fullName) %>%
as.list()
# Get defences players list
defense_list <-  player %>%
filter(posType == "Defenseman" ) %>%
pull(fullName) %>%
as.list()
# Get goalies list
goalie_list <-  player %>%
filter(posType == "Defenseman" ) %>%
pull(fullName) %>%
as.list()
# Get goalies list
goalie_list <-  player %>%
filter(posType == "Goalie" ) %>%
pull(fullName) %>%
as.list()
# Get forwards player list
forwards_list <-  player %>%
filter(posType == "Forward" ) %>%
pull(fullName) %>%
as.list()
# Get defence player list
defense_list <-  player %>%
filter(posType == "Defenseman" ) %>%
pull(fullName) %>%
as.list()
# Get goalies list
goalie_list <-  player %>%
filter(posType == "Goalie" ) %>%
pull(fullName) %>%
as.list()
View(player_stats)
library(shiny)
library(tidyverse)
library(plotly)
# Load data
players <- read_delim("./data/players.txt", delim = ",")
teams <- read_delim("./data/teams.txt", delim = ",")
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
play_plot <- players %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID)) %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_discrete("Players") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
runApp('hockey_analysis_app')
forwards_stats <- players %>%
filter(posType == "Forward") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
View(forwards_stats)
player_stats <- players %>%
filter(posType != "Forward") %>%
right_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
player_stats <- players %>%
filter(posType != "Goalie") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
player_stats <- players %>%
filter(posType != "Goalie") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
player_stats <- players %>%
filter(posType != "Goalie") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
play_plot <- players %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID)) %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral", type = "div") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
play_plot <- players %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID)) %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral", type = "div") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
play_plot <- players %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID)) %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
shiny::runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",") %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
play_plot <- players %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID)) %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
View(goalie_stats)
goalie_stats <- players %>%
filter(posType == "Goalie") %>%
left_join(goalie_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
player_stats <- players %>%
filter(posType != "Goalie") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
play_plot <- player_stats %>%
head(100) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
play_plot <- player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
player_stats %>%
mutate(shooting_perc = goals/shots)
player_stats %>%
mutate(shooting_perc = goals/shots )
player_stats %>%
mutate(shooting_perc = goals/shots )
player_stats %>%
mutate(shooting_perc = goals/)
player_stats %>%
mutate(shooting_perc = goals)
player_stats %>%
mutate(shooting_perc = goals/`shots `)
# Load data
players <- read_delim("./hockey_analysis_app/data/players.txt", delim = ",")
teams <- read_delim("./hockey_analysis_app/data/teams.txt", delim = ",")
goalie_stats <- read_delim("./hockey_analysis_app/data/goalie_stats.txt", delim = ",")
player_stats <- read_delim("./hockey_analysis_app/data/skaters_stats.txt", delim = ",", trim_ws = TRUE) %>%
mutate(season = as.character(season)) %>%
mutate(season = as.character(str_replace(season,
str_sub(season, start = 5, end = 8),
paste("/", str_sub(season, start = 7, end = 8), sep = "")
)
)
)
goalie_stats <- players %>%
filter(posType == "Goalie") %>%
left_join(goalie_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
player_stats <- players %>%
filter(posType != "Goalie") %>%
left_join(player_stats, by = c("playerID" = "playerID")) %>%
mutate(playerID = as.factor(playerID))
play_plot <- player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
player_stats %>%
mutate(shooting_perc = goals/`shots `)
player_stats %>%
mutate(shooting_perc = goals/shots)
player_stats %>%
mutate(shooting_perc = round(goals/shots,2)*100)
player_stats %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line")
player_stats %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line")
player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line")
player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
)
player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100)
ggplotly(player_stats %>%
head(100) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
)
play_plot <- player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=points/games, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
play_plot <- player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=points, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ggtitle("Season Point Totals") +
xlab("Season") +
ylab("Points") +
scale_color_brewer(palette = "Spectral") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
ggplotly(play_plot, tooltip = c("colour", "y"))
View(player_stats)
ggplotly(player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45))
)
ggplotly(player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45)),
tooltip = c("colour", "y")
)
ggplotly(player_stats %>%
head(50) %>%
mutate(shooting_perc = round(goals/shots,2)*100) %>%
ggplot(aes(x=season, y=shooting_perc, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("Shooting Percentage(%)") +
xlab("Season") +
scale_color_discrete("Players") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45)),
tooltip = c("colour", "y")
)
ggplotly(player_stats %>%
head(50) %>%
ggplot(aes(x=season, y=games, group = playerID, color = fullName)) +
geom_point(stat = 'summary', fun.y = sum) +
stat_summary(fun.y = sum, geom = "line") +
ylab("# of Games Played") +
xlab("Season") +
scale_color_discrete("Players") +
theme_bw() +
theme(panel.grid = element_blank(), axis.text.x = element_text(angle = 45)),
tooltip = c("colour", "y")
)
runApp('hockey_analysis_app')
runApp('hockey_analysis_app')
